<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="I'm using these mini-game projects to get up to speed with Unity—learning its components, exploring frequently used APIs, and picking up common game logic patterns along the way.">
<title>【Practice Log】Unity Mini Game Collection 1</title>

<link rel='canonical' href='https://nullshowjl.github.io/en/p/practice-logunity-mini-game-collection-1/'>

<link rel="stylesheet" href="/scss/style.min.3b99540141ea6d96ea57a2341f6a138640e2de77d5547ecfa3a88330ad283de6.css"><meta property='og:title' content="【Practice Log】Unity Mini Game Collection 1">
<meta property='og:description' content="I'm using these mini-game projects to get up to speed with Unity—learning its components, exploring frequently used APIs, and picking up common game logic patterns along the way.">
<meta property='og:url' content='https://nullshowjl.github.io/en/p/practice-logunity-mini-game-collection-1/'>
<meta property='og:site_name' content='Nullshow&#39;s Tech Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Game Dev' /><meta property='article:tag' content='Unity' /><meta property='article:published_time' content='2026-01-10T09:19:30&#43;08:00'/><meta property='article:modified_time' content='2026-01-23T17:12:34&#43;08:00'/><meta property='og:image' content='https://nullshowjl.github.io/en/p/practice-logunity-mini-game-collection-1/cover.webp' />
<meta name="twitter:title" content="【Practice Log】Unity Mini Game Collection 1">
<meta name="twitter:description" content="I'm using these mini-game projects to get up to speed with Unity—learning its components, exploring frequently used APIs, and picking up common game logic patterns along the way."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://nullshowjl.github.io/en/p/practice-logunity-mini-game-collection-1/cover.webp' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
        
        <figure class="site-avatar">
            <a href="/en/">
                
                

                
                
                <img src="/img/avatar_hu_7adbda40a4f6f680.png" width="300"
                     height="300" class="site-logo" loading="lazy" alt="Avatar">
                
                
            </a>
            
            <span class="emoji">✍️</span>
            
        </figure>
        
        

        <div class="site-meta">
            <h1 class="site-name"><a href="/en">Nullshow&#39;s Tech Blog</a></h1>
            <h2 class="site-description">Sharing and documenting my notes, experiences, and reflections from development and learning~</h2>
        </div>
    </header><ol class="menu-social">
        
        
        
        <li>
            <a href='https://gitee.com/nullshow'
                target="_blank" 
                title="Gitee" 
               rel="me">
                
                
                <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-hexagon-letter-g" class="icon-tabler-hexagon-letter-g"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19.875 6.27a2.225 2.225 0 0 1 1.125 1.948v7.284c0 .809 -.443 1.555 -1.158 1.948l-6.75 4.27a2.269 2.269 0 0 1 -2.184 0l-6.75 -4.27a2.225 2.225 0 0 1 -1.158 -1.948v-7.285c0 -.809 .443 -1.554 1.158 -1.947l6.75 -3.98a2.33 2.33 0 0 1 2.25 0l6.75 3.98h-.033z" /><path d="M14 8h-2a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2v-4h-1" /></svg>
                
            </a>
        </li>
        
        
        
        <li>
            <a href='https://github.com/NullshowJL'
                target="_blank" 
                title="GitHub" 
               rel="me">
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-brand-github">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                
            </a>
        </li>
        
        
        
        
        
        <li>
            <a href='/en/index.xml'
                target="_blank" 
                title="RSS" 
               rel="me">
                
                
                <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-rss" class="icon-tabler-brand-rss"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M4 4a16 16 0 0 1 16 16" /><path d="M4 11a9 9 0 0 1 9 9" /></svg>
                
            </a>
        </li>
        
    </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/en/' >
                
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-home">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/en/about/' >
                
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-user">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/en/portfolio/' >
                
                
                
                <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-device-gamepad-2" class="icon-tabler-device-gamepad"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 5h3.5a5 5 0 0 1 0 10h-5.5l-4.015 4.227a2.3 2.3 0 0 1 -3.923 -2.035l1.634 -8.173a5 5 0 0 1 4.904 -4.019h3.4z" /><path d="M14 15l4.07 4.284a2.3 2.3 0 0 0 3.925 -2.023l-1.6 -8.232" /><path d="M8 9v2" /><path d="M7 10h2" /><path d="M14 10h2" /></svg>
                
                <span>Portfolio</span>
            </a>
        </li>
        
        
        <li >
            <a href='/en/study-journey/' >
                
                
                
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-trekking" class="icon-tabler-journey"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M11 4a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M7 21l2 -4" /><path d="M13 21v-4l-3 -3l1 -6l3 4l3 2" /><path d="M10 14l-1.827 -1.218a2 2 0 0 1 -.831 -2.15l.28 -1.117a2 2 0 0 1 1.939 -1.515h1.439l4 1l3 -2" /><path d="M17 12v9" /><path d="M16 20h2" /></svg>
                
                <span>Study Journey</span>
            </a>
        </li>
        
        
        <li >
            <a href='/en/update-log/' >
                
                
                
                <!--
unicode: "fea7"
version: "3.1"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#000000"
  stroke-width="0.5"
  stroke-linecap="round"
  stroke-linejoin="round"
 class="icon-tabler-logs">
  <path d="M4 12h.01" />
  <path d="M4 6h.01" />
  <path d="M4 18h.01" />
  <path d="M8 18h2" />
  <path d="M8 12h2" />
  <path d="M8 6h2" />
  <path d="M14 6h6" />
  <path d="M14 12h6" />
  <path d="M14 18h6" />
</svg>

                
                <span>Update Log</span>
            </a>
        </li>
        
        
        <li >
            <a href='/en/archives/' >
                
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-archives">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/en/search/' >
                
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-search">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/en/links/' >
                
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-link">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                
                <li id="i18n-switch">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-language">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                        <option value="https://nullshowjl.github.io/en/"  selected>English</option>
                        
                        <option value="https://nullshowjl.github.io/" >中文</option>
                        
                    </select>
                </li>
                
                

                
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-toggle-left">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-toggle-right">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-hash">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#merge-big-watermelon">Merge Big Watermelon</a>
      <ol>
        <li><a href="#game-overview">Game Overview</a></li>
        <li><a href="#game-breakdown">Game Breakdown</a>
          <ol>
            <li><a href="#content">Content</a></li>
            <li><a href="#core-logic">Core Logic</a></li>
            <li><a href="#development-steps">Development Steps</a></li>
          </ol>
        </li>
        <li><a href="#problems--solutions">Problems &amp; Solutions</a>
          <ol>
            <li><a href="#1-no-clear-plan">1. No Clear Plan</a></li>
            <li><a href="#2-converting-screen-coordinates-to-world-coordinates">2. Converting Screen Coordinates to World Coordinates</a></li>
            <li><a href="#3-delayed-execution">3. Delayed Execution</a></li>
            <li><a href="#4-assigning-the-singleton-instance">4. Assigning the Singleton Instance</a></li>
            <li><a href="#5-fruit-merging-logic">5. Fruit Merging Logic</a></li>
            <li><a href="#6-custom-font-scaling-issue">6. Custom Font Scaling Issue</a></li>
            <li><a href="#7-sound-effect-spam-on-landing">7. Sound Effect Spam on Landing</a></li>
          </ol>
        </li>
        <li><a href="#reflection">Reflection</a>
          <ol>
            <li><a href="#code-reuse">Code Reuse</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#space-shooter">Space Shooter</a>
      <ol>
        <li><a href="#game-overview-1">Game Overview</a></li>
        <li><a href="#game-breakdown-1">Game Breakdown</a>
          <ol>
            <li><a href="#content-1">Content</a></li>
            <li><a href="#core-logic-1">Core Logic</a></li>
            <li><a href="#development-steps-1">Development Steps</a></li>
          </ol>
        </li>
        <li><a href="#遇到的问题及解决方法">遇到的问题及解决方法</a>
          <ol>
            <li><a href="#1-背景的移动">1. 背景的移动</a></li>
            <li><a href="#2-对刚体的运算要放在fixedupdate中">2. 对刚体的运算要放在<code>FixedUpdate()</code>中</a></li>
            <li><a href="#3-边界检查的一种方法">3. 边界检查的一种方法</a></li>
            <li><a href="#4-利用刚体实现物体的偏转">4. 利用刚体实现物体的偏转</a></li>
            <li><a href="#5-组件化功能挂钩模式">5. “组件化（功能挂钩）”模式</a></li>
            <li><a href="#6-getcomponent-调用的位置时机">6. <code>GetComponent</code> 调用的位置/时机</a></li>
            <li><a href="#7-协程的一般写法">7. 协程的一般写法</a></li>
            <li><a href="#8-小行星自身旋转效果的实现">8. 小行星自身旋转效果的实现</a></li>
            <li><a href="#9-实现敌人发射子弹的两种方法">9. 实现敌人发射子弹的两种方法</a></li>
            <li><a href="#10-敌人闪避的实现思路">10. 敌人闪避的实现思路</a></li>
            <li><a href="#11-ontrigger和oncollison的使用时机">11. <code>OnTrigger</code>和<code>OnCollison</code>的使用时机</a></li>
            <li><a href="#12-特效的销毁的方式方法关注点分离原则">12. 特效的销毁的方式方法（关注点分离原则）</a></li>
          </ol>
        </li>
        <li><a href="#复盘">复盘</a>
          <ol>
            <li><a href="#代码复用">代码复用</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#flappy-bird">Flappy Bird</a>
      <ol>
        <li><a href="#游戏简介">游戏简介</a></li>
        <li><a href="#游戏功能拆解">游戏/功能拆解</a>
          <ol>
            <li><a href="#内容">内容</a></li>
            <li><a href="#逻辑">逻辑</a></li>
            <li><a href="#开发步骤">开发步骤</a></li>
          </ol>
        </li>
        <li><a href="#遇到的问题及解决方法-1">遇到的问题及解决方法</a>
          <ol>
            <li><a href="#1-触屏模式的写法">1. 触屏模式的写法</a></li>
            <li><a href="#2-用invokerepeating-实现简单的动画">2. 用<code>InvokeRepeating </code>实现简单的动画</a></li>
            <li><a href="#3-视差无尽背景的一种实现思路">3. 视差+无尽背景的一种实现思路</a></li>
            <li><a href="#4-管道销毁的另一种思路">4. 管道销毁的另一种思路</a></li>
            <li><a href="#5-unity中的几个坐标系">5. Unity中的几个坐标系</a></li>
            <li><a href="#6-游戏的重启和暂停">6. 游戏的重启和暂停</a></li>
          </ol>
        </li>
        <li><a href="#复盘-1">复盘</a>
          <ol>
            <li><a href="#代码复用-1">代码复用</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#pong">Pong</a>
      <ol>
        <li><a href="#游戏简介-1">游戏简介</a></li>
        <li><a href="#游戏功能拆解-1">游戏/功能拆解</a>
          <ol>
            <li><a href="#内容-1">内容</a></li>
            <li><a href="#逻辑-1">逻辑</a></li>
            <li><a href="#开发步骤-1">开发步骤</a></li>
          </ol>
        </li>
        <li><a href="#遇到的问题及解决方法-2">遇到的问题及解决方法</a>
          <ol>
            <li><a href="#1-angular-drag-和-linear-drag">1. <code>Angular Drag</code> 和 <code>Linear Drag</code></a></li>
            <li><a href="#2-fixedupdate的使用说明">2. <code>FixedUpdate</code>的使用说明</a></li>
            <li><a href="#3-小球接触回弹效果的实现">3. 小球接触回弹效果的实现</a></li>
            <li><a href="#4-使用-eventsystem-实现玩家和电脑的得分">4. 使用 <code>EventSystem</code> 实现玩家和电脑的得分</a></li>
          </ol>
        </li>
        <li><a href="#复盘-2">复盘</a>
          <ol>
            <li><a href="#代码复用-2">代码复用</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#asteroids">Asteroids</a>
      <ol>
        <li><a href="#游戏简介-2">游戏简介</a></li>
        <li><a href="#游戏功能拆解-2">游戏/功能拆解</a>
          <ol>
            <li><a href="#内容-2">内容</a></li>
            <li><a href="#逻辑-2">逻辑</a></li>
            <li><a href="#开发步骤-2">开发步骤</a></li>
          </ol>
        </li>
        <li><a href="#遇到的问题及解决方法-3">遇到的问题及解决方法</a>
          <ol>
            <li><a href="#1-物体间物理碰撞层的设置">1. 物体间物理碰撞层的设置</a></li>
            <li><a href="#2-小行星初始状态的设置">2. 小行星初始状态的设置</a></li>
            <li><a href="#3-小行星生成和移动的实现思路">3. 小行星生成和移动的实现思路</a></li>
            <li><a href="#4-玩家无敌时间的设计思路">4. 玩家无敌时间的设计思路</a></li>
            <li><a href="#5-粒子系统的设置">5. 粒子系统的设置</a></li>
          </ol>
        </li>
        <li><a href="#复盘-3">复盘</a>
          <ol>
            <li><a href="#代码复用-3">代码复用</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/en/p/practice-logunity-mini-game-collection-1/">
                <img src="/en/p/practice-logunity-mini-game-collection-1/cover_hu_f2474a95057c3071.webp"
                        srcset="/en/p/practice-logunity-mini-game-collection-1/cover_hu_f2474a95057c3071.webp 800w, /en/p/practice-logunity-mini-game-collection-1/cover_hu_55bae819dfc301f2.webp 1600w"
                        width="800" 
                        height="240" 
                        loading="lazy"
                        alt="Featured image of post 【Practice Log】Unity Mini Game Collection 1" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/en/categories/study-notes/" style="background-color: #2a9d8f; color: #fff;">
                Study Notes
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/en/p/practice-logunity-mini-game-collection-1/">【Practice Log】Unity Mini Game Collection 1</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            I&#39;m using these mini-game projects to get up to speed with Unity—learning its components, exploring frequently used APIs, and picking up common game logic patterns along the way.
        </h3>
        
    </div>

    
    
    
    
<footer class="article-time">
    
    <div>
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-date">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
        <time class="article-time--published">Jan 10, 2026</time>
    </div>
    

    
    <div>
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-clock">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--reading">
            23 minute read
        </time>
    </div>
    

    
    <div id="viewCount">
        <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-eye" class="icon-tabler-eye"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" /><path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" /></svg>
        <time class="article-time--reading">
            
            <span id="vercount_value_page_pv">loading... </span> views
        </time>
    </div>

</footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p><strong>目录</strong></p>
<ul>
<li>[Merge Big Watermelon](#Merge Big Watermelon)</li>
<li>[Space Shooter](#Space Shooter)</li>
<li>[Flappy Bird](#Flappy Bird)</li>
<li><a class="link" href="#Pong" >Pong</a></li>
<li><a class="link" href="#Asteroids" >Asteroids</a></li>
</ul>
<p>The games in this practice series are all intentionally small. The goal is to get comfortable with Unity’s APIs, sharpen my problem-solving mindset, and explore different ways of thinking. The top priority is to quickly build working prototypes or extract reusable code snippets. Things like overall architecture or long-term scalability aren’t the focus here.</p>
<h2 id="merge-big-watermelon">Merge Big Watermelon
</h2><p><strong>Tutorial Reference and Assets Source</strong>：<a class="link" href="https://www.bilibili.com/video/BV18i4y1a7wR?vd_source=b1a61d6b078b6e795dda5bac409d910e"  target="_blank" rel="noopener"
    >Bilibili-YouChiHui</a></p>
<p><strong>Source Code</strong>： <a class="link" href="https://gitee.com/nullshow/unity-mini-game-merge-big-watermelon"  target="_blank" rel="noopener"
    >on Gitee</a></p>
<h3 id="game-overview">Game Overview
</h3><p><strong>Merge Big Watermelon</strong> is a casual browser game released by Weisun Games in early 2021. It quickly went viral thanks to its easy-to-learn mechanics, addictive gameplay, and strong social sharing appeal.</p>
<p><strong>Core Gameplay:</strong></p>
<ul>
<li>Players tap the screen to drop random fruits from the top—grapes, oranges, apples, and so on.</li>
<li>When two identical fruits collide, they merge into a larger one: two grapes become a cherry, two cherries become an orange, and so on. The ultimate goal is to create the biggest fruit—the watermelon.</li>
<li>The game blends mechanics from Tetris and 2048: fruits fall and stack under gravity, and the game ends if the pile crosses the top of the screen.</li>
</ul>
<img src="1-watermelon.gif" alt="" style="zoom:100%;"/>
<h3 id="game-breakdown">Game Breakdown
</h3><h4 id="content">Content
</h4><ul>
<li>
<p>Background image</p>
</li>
<li>
<p>Walls and floor</p>
</li>
<li>
<p>Fruits (active and standby)</p>
</li>
<li>
<p>Game-over line</p>
</li>
<li>
<p>UI (score display)</p>
</li>
<li>
<p>Sound effects (landing, merging)</p>
</li>
</ul>
<h4 id="core-logic">Core Logic
</h4><ol>
<li>The standby fruit follows the mouse along the X-axis while the mouse is held down, and drops when released</li>
<li>Fruits bounce and collide with each other when they land. If two identical fruits touch, they merge into a bigger one</li>
<li>If any fruit crosses the game-over line, the game ends and the scene reloads</li>
<li>The current score is displayed on screen.</li>
</ol>
<h4 id="development-steps">Development Steps
</h4><ol>
<li>Set up the scene layout</li>
<li>Add gravity, collision, and bounce physics to fruits and other objects</li>
<li>Turn fruits into prefabs</li>
<li>Make the standby fruit follow the mouse</li>
<li>Drop the fruit when the mouse is released</li>
<li>Handle fruit merging logic</li>
<li>Detect when fruits hit or cross the game-over line</li>
<li>Display the score in the UI</li>
<li>Add sound effects</li>
</ol>
<h3 id="problems--solutions">Problems &amp; Solutions
</h3><h4 id="1-no-clear-plan">1. No Clear Plan
</h4><p>When I got stuck, I used the classic “How do you put an elephant in a fridge?” mindset—break things down into the tiniest possible steps. For example, Step 4 in the development plan (“make the standby fruit follow the mouse”) can be broken down like this:</p>
<ul>
<li>Create an array of standby fruits (types 1–4)</li>
<li>Define a spawn point for the standby fruit</li>
<li>Randomly pick a fruit from the array to spawn</li>
<li>On mouse down, get the mouse’s position and apply it to the fruit (only update the X-axis; keep Y and Z unchanged)</li>
<li>Add boundary checks so the fruit doesn’t move past the left/right walls</li>
</ul>
<h4 id="2-converting-screen-coordinates-to-world-coordinates">2. Converting Screen Coordinates to World Coordinates
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// Screen Coordinates -&gt; World Coordinates</span>
</span></span><span class="line"><span class="cl"><span class="n">Vector3</span> <span class="n">screenPoint</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="n">mousePosition</span><span class="p">;</span> <span class="c1">// eg. The position of the mouse</span>
</span></span><span class="line"><span class="cl"><span class="n">Vector3</span> <span class="n">worldPoint</span> <span class="p">=</span> <span class="n">Camera</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">ScreenToWorldPoint</span><span class="p">(</span><span class="n">screenPoint</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// World Coordinates -&gt; Screen Coordinates</span>
</span></span><span class="line"><span class="cl"><span class="n">Vector3</span> <span class="n">worldPos</span> <span class="p">=</span> <span class="n">player</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Vector3</span> <span class="n">screenPos</span> <span class="p">=</span> <span class="n">Camera</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">WorldToScreenPoint</span><span class="p">(</span><span class="n">worldPos</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>One thing to watch out for: since the main camera in Unity is positioned at Z = -10 in world space, you need to manually set the Z value to 0 when converting screen coordinates to world coordinates for 2D objects. Otherwise, the object might not be visible—it’ll be behind the camera.</p>
<blockquote class="alert alert-note">
    <p>In Unity, the origin of screen coordinates is at the bottom-left corner</p></blockquote>
<h4 id="3-delayed-execution">3. Delayed Execution
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="n">Invoke</span><span class="p">(</span><span class="s">&#34;funcName&#34;</span><span class="p">,</span> <span class="n">second</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="4-assigning-the-singleton-instance">4. Assigning the Singleton Instance
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// After marking a class as a singleton, don’t forget to assign the instance in Awake()</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">PlayerManager</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">PlayerManager</span> <span class="n">Instance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">GameObject</span><span class="p">[]</span> <span class="n">fruits</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Transform</span> <span class="n">createPoint</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [HideInInspector]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">GameObject</span> <span class="n">waitingFruit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Instance</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// Other codes</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="5-fruit-merging-logic">5. Fruit Merging Logic
</h4><p>Each fruit has a unique ID, so it can be used to identify individual objects. To avoid both fruits triggering a merge at the same time, only the one with the higher ID is allowed to spawn the next-level fruit.</p>
<h4 id="6-custom-font-scaling-issue">6. Custom Font Scaling Issue
</h4><p>Custom fonts didn’t scale properly using the usual font size settings, it can be fixed by scaling the entire object instead.</p>
<h4 id="7-sound-effect-spam-on-landing">7. Sound Effect Spam on Landing
</h4><p>设定当velocity超过一定数值时才播放音效，避免因为一点移动就播放音效从而感觉很杂乱的问题。</p>
<p>To avoid messy audio from tiny movements, a velocity threshold can be set to help with this—only play the landing sound if the fruit’s velocity is above a certain value.</p>
<h3 id="reflection">Reflection
</h3><p>This was my first hands-on Unity project. I tried to write all the code myself, only checking tutorials when I got stuck—then I’d go back and implement the logic on my own. Whenever I hit an unfamiliar API, I’d dig into my old notes or check the official docs. That really helped the knowledge stick.</p>
<p>The demo covers the core gameplay, though there are still a few bugs. For example, sometimes the game doesn’t restart even when fruits stack past the game-over line. Also, after merging into the final watermelon, I still need to add a victory screen and scene. I’ll revisit to polish those once I’ve finished a few more practice projects.</p>
<h4 id="code-reuse">Code Reuse
</h4><h5 id="1-use-singleton-pattern-for-all-manager-classes">1. Use Singleton Pattern for All “Manager” Classes
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// Take PlayerManager for example</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">PlayerManager</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">PlayerManager</span> <span class="n">Instance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Instance</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Other codes</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="2-make-the-game-object-follow-the-mouse">2. Make the game object follow the mouse
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">PlaceFruit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Get the mouse position in screen coordinates</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Convert it to world coordinates</span>
</span></span><span class="line"><span class="cl">    <span class="n">Vector3</span> <span class="n">mousePos</span> <span class="p">=</span> <span class="n">Camera</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">ScreenToWorldPoint</span><span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">mousePosition</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// When the left mouse button is held down, move the standby fruit with the mouse</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// In this case, the fruit only follows the mouse along the X-axis</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">GetMouseButton</span><span class="p">(</span><span class="m">0</span><span class="p">))</span>	
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">waitingFruit</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">mousePos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">waitingFruit</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="space-shooter">Space Shooter
</h2><p><strong>Tutorial Reference and Assets Source</strong>：<a class="link" href="https://www.bilibili.com/video/BV1wW411N7Ew?vd_source=b1a61d6b078b6e795dda5bac409d910e"  target="_blank" rel="noopener"
    >Bilibili-QiQiKer-Plane</a></p>
<p><strong>Source Code</strong>： <a class="link" href="https://gitee.com/nullshow/unity-mini-game-space-shooter"  target="_blank" rel="noopener"
    >on Gitee</a></p>
<h3 id="game-overview-1">Game Overview
</h3><p><strong>Space Shooter</strong> is an official Unity 3D beginner tutorial project designed to help newcomers quickly grasp the basics of Unity development. It covers core concepts such as scene setup, player control, enemy spawning, collision detection, UI display, and audio integration. This version builds on the original tutorial by adding upgraded features—like enemies that can fire bullets.</p>
<p><strong>Core Gameplay</strong>:</p>
<ul>
<li><strong>Genre</strong>: 2D space shooter (with a 3D top-down view)</li>
<li><strong>Objective</strong>: Pilot your spaceship and survive as long as possible while destroying waves of enemies and asteroids.</li>
<li><strong>Controls</strong>:
<ul>
<li><strong>Movement</strong>: Use WASD or arrow keys to move freely within the screen</li>
<li><strong>Shooting</strong>: Left mouse button fires bullets</li>
</ul>
</li>
<li><strong>Enemy Behavior</strong>:
<ul>
<li>Asteroids and enemy ships spawn randomly from the top of the screen, falling at different speeds</li>
<li>Enemies move side-to-side and shoot bullets at the player</li>
<li>The player must dodge or destroy them to avoid collisions or being hit by enemy fire</li>
</ul>
</li>
<li><strong>Game Over</strong>: The game ends if the spaceship is hit by an asteroid or a bullet</li>
<li><strong>Scoring System</strong>: Each destroyed enemy adds points, with the UI showing the score in real time</li>
</ul>
<img src="2-space_shooter.gif" alt="" style="zoom:100%;"/>
<h3 id="game-breakdown-1">Game Breakdown
</h3><h4 id="content-1">Content
</h4><ul>
<li>Scene setup</li>
</ul>
<ul>
<li>
<p>Background slowly scrolling downward</p>
</li>
<li>
<p>Animations: enemy explosions, asteroid explosions, ship tilting when moving left/right, asteroid rotation</p>
</li>
<li>
<p>UI: score display</p>
</li>
<li>
<p>Audio: background music, shooting, hit effects</p>
</li>
</ul>
<h4 id="core-logic-1">Core Logic
</h4><ol>
<li>Player can move in all four directions and shoot bullets</li>
<li>Asteroids spawn randomly at the top of the screen and fall at a constant speed</li>
<li>Enemies spawn randomly at the top, move down faster, dodge left/right, and fire bullets</li>
<li>Current score is displayed in the UI</li>
<li>If the player is hit by enemy bullets or collides with asteroids/enemies, the ship is destroyed and the scene reloads</li>
</ol>
<h4 id="development-steps-1">Development Steps
</h4><ol start="5">
<li>
<p>UI部分</p>
<ul>
<li>搭建UI界面</li>
</ul>
</li>
</ol>
<ul>
<li>实现UI显示逻辑</li>
</ul>
<ol>
<li>
<p>Background Setup</p>
<ul>
<li>Looping background movement</li>
<li>Add starfield particle effects</li>
<li>Add background music</li>
</ul>
</li>
<li>
<p>Player Implementation</p>
<ul>
<li>Player movement controls</li>
<li>Tilting effect when moving left/right (greater speed = larger tilt angle)</li>
<li>Shooting mechanics</li>
<li>Player bullets with sound effects</li>
</ul>
</li>
<li>
<p>Enemies &amp; Asteroids</p>
<ul>
<li>Random spawning of asteroids and enemies</li>
<li>Random asteroid rotation effect</li>
<li>Enemy shooting logic</li>
<li>Enemy side-to-side dodging movement</li>
</ul>
</li>
<li>
<p>Effects</p>
<ul>
<li>Attack and collision effects</li>
</ul>
</li>
<li>
<p>UI</p>
<ul>
<li>Build the UI layout</li>
<li>Implement score display logic</li>
</ul>
</li>
</ol>
<h3 id="遇到的问题及解决方法">遇到的问题及解决方法
</h3><h4 id="1-背景的移动">1. 背景的移动
</h4><p>让背景移动还是摄像机移动呢？通常选择让背景移动，因为游戏场景中还会有小行星、玩家、敌人等各种物体，保持摄像机不动是一种更简单的方式。</p>
<p>需要注意的是，和做“往复”有关的计算时，因为要与绝对时间同步，所以使用 <code>Time.time</code>；在做一般位移、计时、累加时，因为需要确保与帧率无法，使用<code>Time.deltaTime</code>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// 位移的计算（一般使用API）</span>
</span></span><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">Translate</span><span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">forward</span> <span class="p">*</span> <span class="m">1</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">,</span> <span class="n">space</span><span class="p">.</span><span class="n">World</span><span class="p">);</span> <span class="c1">// 如果是自己坐标系：Space.Self</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 背景循环往复</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">ScrollBG</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">distance</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Repeat</span><span class="p">(</span><span class="n">_scrollSpeed</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">time</span><span class="p">,</span> <span class="m">30</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">_startPos</span> <span class="p">+</span> <span class="n">distance</span> <span class="p">*</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">forward</span> <span class="p">*</span> <span class="p">(-</span><span class="m">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2-对刚体的运算要放在fixedupdate中">2. 对刚体的运算要放在<code>FixedUpdate()</code>中
</h4><p>因为<code>Update()</code>中每一帧的时间可能不同，取决于设备的性能、运算的复杂程度等，所以如果将刚体运算放置其中可能会出现一些卡顿等情况。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// 通过对刚体的操作来控制玩家的运动</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">FixedUpdate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">MovePlayer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">MovePlayer</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">horizontalVel</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="n">GetAxis</span><span class="p">(</span><span class="s">&#34;Horizontal&#34;</span><span class="p">);</span> <span class="c1">// 0-1</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">verticalVel</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="n">GetAxis</span><span class="p">(</span><span class="s">&#34;Vertical&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Vector3</span> <span class="n">velocity</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">horizontalVel</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">verticalVel</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">_playerRB</span><span class="p">.</span><span class="n">velocity</span> <span class="p">=</span> <span class="n">velocity</span> <span class="p">*</span> <span class="n">_speed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Other codes</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="3-边界检查的一种方法">3. 边界检查的一种方法
</h4><p>通过在面板中直观地检查边界的位置，感觉比纯用代码控制简便。先在类内创建一个结构体并序列化，然后在代码中调用。(不要忘记将Border类实例化)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">PlayerController</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Serializable]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">struct</span> <span class="nc">Border</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">float</span> <span class="n">maxZ</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">float</span> <span class="n">minZ</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">float</span> <span class="n">minX</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">float</span> <span class="n">maxX</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">    
</span></span></span><span class="line"><span class="cl"><span class="na">    [SerializeField]</span> <span class="kd">private</span> <span class="n">Border</span> <span class="n">_border</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// Other codes</span>
</span></span><span class="line"><span class="cl">	<span class="kd">private</span> <span class="k">void</span> <span class="n">MovePlayer</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      	<span class="c1">// Other codes</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// Border check</span>
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">posX</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Clamp</span><span class="p">(</span><span class="n">_playerRB</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">_border</span><span class="p">.</span><span class="n">minX</span><span class="p">,</span> <span class="n">_border</span><span class="p">.</span><span class="n">maxX</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">posZ</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Clamp</span><span class="p">(</span><span class="n">_playerRB</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">_border</span><span class="p">.</span><span class="n">minZ</span><span class="p">,</span> <span class="n">_border</span><span class="p">.</span><span class="n">maxZ</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">_playerRB</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">posX</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">posZ</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="4-利用刚体实现物体的偏转">4. 利用刚体实现物体的偏转
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// 物体绕y轴旋转30°</span>
</span></span><span class="line"><span class="cl"><span class="n">Quaternion</span> <span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">Euler</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 可以直接利用刚体的rotation属性</span>
</span></span><span class="line"><span class="cl"><span class="n">_playerRb</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">Euler</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">_playerRb</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span> <span class="p">*</span> <span class="p">(-</span><span class="m">1</span><span class="p">)</span> <span class="p">*</span> <span class="n">tilt</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="5-组件化功能挂钩模式">5. “组件化（功能挂钩）”模式
</h4><p>把可复用的功能拆成小组件（例如 MoveController），再由具体行为脚本（例如 PlayerController / EnemyController）组合调用。</p>
<p><strong>优点</strong>：复用性高、职责清晰、易测试、易维护；遵循 composition over inheritance。
<strong>缺点</strong>：某些对象会挂多个小脚本，但这是合理的单一职责拆分，性能影响很小。
<strong>实践要点</strong>：保持组件单一职责、用接口/事件解耦、用 RequireComponent、把共享数据放到 ScriptableObject 或配置类、用 Prefab 组合复用。</p>
<p>“实践要点”有点难以理解。在“2048”项目中曾经看到过一次，以后对这方面的实践需要多加留意体会。</p>
<h4 id="6-getcomponent-调用的位置时机">6. <code>GetComponent</code> 调用的位置/时机
</h4><p>在实践中推荐的做法是，如果同一物体上获取并缓存组件用 <code>Awake()</code>，如果依赖别的对象在 <code>Awake()</code> 中完成的初始化则放到 <code>Start()</code>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// 要获得同一个物体MoveController身上的刚体组件</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">MoveController</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Rigidbody</span> <span class="n">rb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>	<span class="c1">// 在Awake()中获取刚体组件</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">rb</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">Move</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">dir</span><span class="p">,</span> <span class="kt">float</span> <span class="n">speed</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">rb</span><span class="p">.</span><span class="n">velocity</span> <span class="p">=</span> <span class="n">dir</span><span class="p">.</span><span class="n">normalized</span> <span class="p">*</span> <span class="n">speed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 依赖别的对象在 Awake() 中初始化的值，所以在 Start() 使用</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">EnemyAI</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">MoveController</span> <span class="n">move</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Transform</span> <span class="n">player</span><span class="p">;</span> <span class="c1">// 假设 Player 在 Awake() 设置好</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">move</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">MoveController</span><span class="p">&gt;();</span>	<span class="c1">// 另一个对象MoveController在Start()中获取组件</span>
</span></span><span class="line"><span class="cl">        <span class="n">player</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="n">FindWithTag</span><span class="p">(</span><span class="s">&#34;Player&#34;</span><span class="p">)?.</span><span class="n">transform</span><span class="p">;</span> <span class="c1">// 等待所有 Awake 完成后再查找使用更安全</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Update</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">player</span> <span class="p">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Vector3</span> <span class="n">dir</span> <span class="p">=</span> <span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="n">position</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">dir</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="m">0f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">move</span><span class="p">.</span><span class="n">Move</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="m">3f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="7-协程的一般写法">7. 协程的一般写法
</h4><p>需要注意以下几点：</p>
<ul>
<li>定义返回类型为 IEnumerator 的方法，方法内使用 yield return 返回等待（null、new WaitForSeconds(&hellip;)、WaitForEndOfFrame 等）</li>
<li>用 StartCoroutine(MyCoroutine()) 启动；可用 StopCoroutine 停止*</li>
<li>不要在主线程（比如 Start()）里写不会 yield 的 while(true)，那会卡死主线程</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// 利用协程生成和销毁敌人</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 把循环放到协程里并用 Instantiate 生成敌人，用另一个协程在延时后销毁</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">StartCoroutine</span><span class="p">(</span><span class="n">SpawnEnemyWave</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">IEnumerator</span> <span class="n">SpawnEnemyWave</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="n">WaitForSeconds</span><span class="p">(</span><span class="n">startSpawnTime</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">enemyCount</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">GameObject</span> <span class="n">prefab</span> <span class="p">=</span> <span class="n">enemies</span><span class="p">[</span><span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">enemies</span><span class="p">.</span><span class="n">Length</span><span class="p">)];</span>
</span></span><span class="line"><span class="cl">            <span class="n">GameObject</span> <span class="n">newEnemy</span> <span class="p">=</span> <span class="n">Instantiate</span><span class="p">(</span><span class="n">prefab</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">newEnemy</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(-</span><span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span> <span class="m">2</span><span class="p">,</span> <span class="m">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="n">WaitForSeconds</span><span class="p">(</span><span class="n">spawnWaitingTime</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Enemy和其子弹全部和Player的子弹一样，用KillBox统一销毁</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="8-小行星自身旋转效果的实现">8. 小行星自身旋转效果的实现
</h4><p>使用API<code>Random.insideUnitSphere</code>, 返回一个随机的 <code>Vector3</code>，方向和大小在单位球体内随机分布；然后通过乘以 <code>rotationSpeed</code> 会把这个向量缩放到期望的角速度大小；最后赋值给<code>Rigidbody.angularVelocity</code>：向量的方向表示旋转轴，向量的长度表示角速度（弧度/秒），所以刚体会绕该随机轴以该速度旋转。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"> <span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="n">_rb</span><span class="p">.</span><span class="n">angularVelocity</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">insideUnitSphere</span> <span class="p">*</span> <span class="n">rotationSpeed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="9-实现敌人发射子弹的两种方法">9. 实现敌人发射子弹的两种方法
</h4><p>方法一：和玩家发射子弹的思路类似，用累加时间的方法。</p>
<p>方法二：使用API<code>InvokeRepeating(string methodName, float time, float repeatRate)</code> 。含义：在 <code>time</code> 秒后调用 <code>methodName</code> 方法，然后每 <code>repeatRate</code> 秒调用一次。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// 方法一的实现</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Update</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">SpawnBullet</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">SpawnBullet</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">_waitingTime</span> <span class="p">+=</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">_waitingTime</span> <span class="p">&gt;</span> <span class="n">cooldown</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Instantiate</span><span class="p">(</span><span class="n">bullet</span><span class="p">,</span> <span class="n">shootPos</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">AudioMgr</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">PlayAudio</span><span class="p">(</span><span class="n">AudioMgr</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">clips</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="n">_waitingTime</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 方法二的实现</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">InvokeRepeating</span><span class="p">(</span><span class="s">&#34;SpawnBullet&#34;</span><span class="p">,</span> <span class="n">startingTime</span><span class="p">,</span> <span class="n">cooldown</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">SpawnBullet</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Instantiate</span><span class="p">(</span><span class="n">bullet</span><span class="p">,</span> <span class="n">shootPos</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">AudioMgr</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">PlayAudio</span><span class="p">(</span><span class="n">AudioMgr</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">clips</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="10-敌人闪避的实现思路">10. 敌人闪避的实现思路
</h4><p>敌人在生成一段时间（随机值）后进行闪避，如果敌人生成在屏幕的左半边则向右移动，如果在右半边则向左移动，一段时间（随机值）后停止左/右移动，继续向下移动，然后进入下一个闪避的循环，直到被自然销毁。</p>
<ul>
<li>使用协程实现一段时间闪避然后继续保持竖直下行的行动</li>
<li>为了让敌人的闪避看起来平滑和自然，使用一个加速度通过API<code>Mathf.Lerp(float a, float b, float t)</code>来实现。<code>a</code>为起点值，<code>b</code>为终点值，<code>t</code>为两个浮点数之间的插值</li>
<li>敌人在移动过程中注意边界检查</li>
</ul>
<p>教程中使用<code>Mathf.MoveTowards(float current, float target, float maxDelta)</code>实现，这个API本质上与<code>Mathf.Lerp</code>相同，将值<code>current</code>平滑地向<code>target</code>靠近。但是使用这个方法需要大幅提高加速度的值，否则敌人会不产生闪避的行为。原因在于这两者的本质差别：<code>Lerp</code> 用的是比例插值（t 是个 0~1 的比率），会按比例“拉”向目标，哪怕目标在另一侧也会生成小的反向速度；<code>MoveTowards</code> 用的是绝对步长（<code>maxDelta</code>），每帧只移动固定的量。如果用于 <code>MoveTowards</code> 的 <code>maxDelta</code> 太小（比如 <code>acceleration</code> 很小），每帧的速度变化被其他物理因素（摩擦、重置、阈值判断）淹没，看起来像“没有发生闪避”。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">StartCoroutine</span><span class="p">(</span><span class="n">Dodge</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">FixedUpdate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// float xVel = Mathf.MoveTowards(_rb.velocity.x, _targetDodgeSpeed, Time.fixedDeltaTime * acceleration);  // 100</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">xVel</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Lerp</span><span class="p">(</span><span class="n">_rb</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">_targetDodgeSpeed</span><span class="p">,</span> <span class="n">Time</span><span class="p">.</span><span class="n">fixedDeltaTime</span> <span class="p">*</span> <span class="n">acceleration</span><span class="p">);</span> <span class="c1">// 20</span>
</span></span><span class="line"><span class="cl">    <span class="n">_rb</span><span class="p">.</span><span class="n">velocity</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">xVel</span><span class="p">,</span> <span class="n">_rb</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">_rb</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">IEnumerator</span> <span class="n">Dodge</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="n">WaitForSeconds</span><span class="p">(</span><span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="n">startingTimeMin</span><span class="p">,</span> <span class="n">startingTimeMax</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">_targetDodgeSpeed</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="n">dodgeSpeedMin</span><span class="p">,</span> <span class="n">dodgeSpeedMax</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 如果敌人出现在屏幕中线右侧向左闪避</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 如果出现在左侧，那么自然速度是正，向左闪避，不用改</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">_rb</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">)</span>   
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">_targetDodgeSpeed</span> <span class="p">=</span> <span class="p">-</span><span class="n">_targetDodgeSpeed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">targetTime</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="n">movingTimeMin</span><span class="p">,</span> <span class="n">movingTimeMax</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="n">WaitForSeconds</span><span class="p">(</span><span class="n">targetTime</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">_targetDodgeSpeed</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="11-ontrigger和oncollison的使用时机">11. <code>OnTrigger</code>和<code>OnCollison</code>的使用时机
</h4><p>两者都可以用于碰撞检测。</p>
<p>OnCollision用于实际碰撞并产生物理反应的场景，所以开销较大，适用于物理交互时，如碰撞、反弹、受力等。</p>
<p>OnTrigger只检测重叠，不自动产生物理反应，因为通常不计算接触点/冲量，所以开销比OnCollision小些，适用于范围检测、触发器区域、捡取、伤害区域等。</p>
<h4 id="12-特效的销毁的方式方法关注点分离原则">12. 特效的销毁的方式方法（关注点分离原则）
</h4><p>特效的销毁放在一个单独的脚本中，不要和<code>CollisionCheck</code> 脚本放在一起。这样可以是关注点分离（<code>CollisionCheck</code> 只负责触发/判定），可复用性高，便于切换为对象池而不是每次销毁。</p>
<h3 id="复盘">复盘
</h3><p>教程提供了一些很新颖的思路，在这个游戏中开始尝试自己写协程，并且尽量练习了上一个游戏中学到的单例模式。在一些我有疑问的时候或者觉得教程的处理超出我认知的时候问了AI，基本都得到满意的答复，感觉用这种项目驱动的学习方法真的很高效且因为有很多即时反馈，所以心理上也不太容易有疲惫感。</p>
<p>也有一些自己看了AI的回答和教程的讲解也不太明白的地方，比如“组件单一职责、用接口/事件解耦”等，留待在以后的游戏实战项目中慢慢实践体会。</p>
<p>还有很棒的一点是，学到了原来Unity开始界面的logo是可以替换的，马上做了一张小logo替换，效果真的不错！</p>
<h4 id="代码复用">代码复用
</h4><h5 id="1-滚动的无限背景">1. 滚动的无限背景
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="na">[SerializeField]</span> <span class="kd">private</span> <span class="kt">float</span> <span class="n">_scrollSpeed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">Vector3</span> <span class="n">_startPos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">_startPos</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Update</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">ScrollBG</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">ScrollBG</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">distance</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Repeat</span><span class="p">(</span><span class="n">_scrollSpeed</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">time</span><span class="p">,</span> <span class="m">30</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">_startPos</span> <span class="p">+</span> <span class="n">distance</span> <span class="p">*</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">forward</span> <span class="p">*</span> <span class="p">(-</span><span class="m">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="2-旋转效果">2. 旋转效果
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// 球体的随机旋转</span>
</span></span><span class="line"><span class="cl"><span class="n">_rb</span><span class="p">.</span><span class="n">angularVelocity</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">insideUnitSphere</span> <span class="p">*</span> <span class="n">rotationSpeed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 3D物体随某个轴的速度发生倾斜（此例中是随x轴上的速度）</span>
</span></span><span class="line"><span class="cl"> <span class="n">_rb</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">Euler</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">_rb</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span> <span class="p">*</span> <span class="p">(-</span><span class="m">1</span><span class="p">)</span> <span class="p">*</span> <span class="n">tilt</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">float</span> <span class="n">posX</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Clamp</span><span class="p">(</span><span class="n">_rb</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">border</span><span class="p">.</span><span class="n">minX</span><span class="p">,</span> <span class="n">border</span><span class="p">.</span><span class="n">maxX</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">_rb</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="k">new</span><span class="p">(</span><span class="n">posX</span><span class="p">,</span> <span class="n">_rb</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">_rb</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="3-movecontroller">3. <code>MoveController</code>
</h5><p>使用刚体，可以复用在所有在z轴方向运动的物体。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">MoveController</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="na">   [SerializeField]</span> <span class="kd">private</span> <span class="kt">float</span> <span class="n">flySpeed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="kd">private</span> <span class="n">Rigidbody</span> <span class="n">_rb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="kd">private</span> <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">_rb</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kd">private</span> <span class="k">void</span> <span class="n">FixedUpdate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">_rb</span><span class="p">.</span><span class="n">velocity</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">forward</span> <span class="p">*</span> <span class="n">flySpeed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="4-destroybytime">4. <code>DestroyByTime</code>
</h5><p>复用在特效的自动销毁上。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">DestroyByTime</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="na">    [SerializeField]</span> <span class="kd">private</span> <span class="kt">float</span> <span class="n">delay</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Destroy</span><span class="p">(</span><span class="n">gameObject</span><span class="p">,</span> <span class="n">delay</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="5-audiomanager">5. <code>AudioManager</code>
</h5><p>复用在全部音效的管理和播放上。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">AudioMgr</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">AudioMgr</span> <span class="n">Instance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">AudioClip</span><span class="p">[]</span> <span class="n">clips</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">AudioSource</span> <span class="n">_audioSource</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Instance</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">_audioSource</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">AudioSource</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">PlayAudio</span><span class="p">(</span><span class="n">AudioClip</span> <span class="n">clip</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_audioSource</span><span class="p">.</span><span class="n">PlayOneShot</span><span class="p">(</span><span class="n">clip</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="flappy-bird">Flappy Bird
</h2><p><strong>Tutorial Reference and Assets Source</strong>：<a class="link" href="https://www.youtube.com/watch?v=ihvBiJ1oC9U"  target="_blank" rel="noopener"
    >油管-Zigurous</a></p>
<p><strong>Source Code</strong>： <a class="link" href="https://gitee.com/nullshow/unity-mini-game-flappy-bird"  target="_blank" rel="noopener"
    >on Gitee</a></p>
<h3 id="游戏简介">游戏简介
</h3><p>《飞翔的小鸟》（Flappy Bird）是一款由越南开发者Dong Nguyen于2013年发行的简易2D手机游戏。游戏因其极低的画面复杂性、极高的难度和令人“上瘾”的挫败感而迅速走红，一度成为全球现象级游戏。</p>
<p><strong>核心玩法</strong>：</p>
<ul>
<li><strong>类型</strong>：像素风格2D游戏，背景为卷轴式滚动，角色是一只简单的像素小鸟</li>
<li><strong>目标</strong>：控制小鸟穿越由上下管道组成的障碍，飞得越远得分越高</li>
<li><strong>操作方式</strong>：
<ul>
<li>点击屏幕（或按任意键），小鸟向上扇动翅膀，短暂上升</li>
<li>不操作时，小鸟受重力影响持续下落</li>
</ul>
</li>
<li><strong>障碍机制</strong>：
<ul>
<li>场景中随机出现高低不一的“绿色管道”，小鸟需从管道间隙穿过</li>
<li>触碰到管道、地面都会导致游戏立即结束</li>
</ul>
</li>
<li><strong>失败条件</strong>：小鸟碰到障碍物或地面则失败</li>
<li><strong>计分系统</strong>：每成功穿过一对管道得1分，无最高分限制</li>
</ul>
<img src="3-flappy_bird.gif" alt="" style="zoom:100%;"/>
<h3 id="游戏功能拆解">游戏/功能拆解
</h3><h4 id="内容">内容
</h4><p>场景摆放（背景视差效果、无限滚动）、动画（小鸟飞翔）、UI（分数）、音效（得分、撞击）</p>
<h4 id="逻辑">逻辑
</h4><ol>
<li>小鸟自动前进并随重力作用自然下落</li>
<li>玩家可以按下<code>W</code>键、上方向键或者点击鼠标左键让小鸟向上运动</li>
<li>如果小鸟在前进过程中碰到了管道或地面则游戏失败</li>
<li>显示当前的分数</li>
</ol>
<h4 id="开发步骤">开发步骤
</h4><ol>
<li>
<p>小鸟部分</p>
<ul>
<li>
<p>小鸟的移动</p>
</li>
<li>
<p>小鸟飞翔动画的实现</p>
</li>
</ul>
</li>
<li>
<p>背景部分</p>
<ul>
<li>
<p>背景的制作</p>
</li>
<li>
<p>背景视差的实现</p>
</li>
</ul>
</li>
<li>
<p>管道部分</p>
<ul>
<li>管道预制体的制作</li>
<li>管道的生成</li>
<li>管道的运动</li>
</ul>
</li>
<li>
<p>得分</p>
</li>
<li>
<p>UI的设计/设置</p>
</li>
<li>
<p>菜单交互功能的实现</p>
</li>
<li>
<p>添加音效</p>
</li>
</ol>
<h3 id="遇到的问题及解决方法-1">遇到的问题及解决方法
</h3><h4 id="1-触屏模式的写法">1. 触屏模式的写法
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">// 以控制小鸟向上移动为例</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 触屏模式</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">touchCount</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>   <span class="c1">// 只要手指接触到屏幕</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Touch</span> <span class="n">touch</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="n">GetTouch</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>    <span class="c1">// 获取首次屏幕按触</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">touch</span><span class="p">.</span><span class="n">phase</span> <span class="p">==</span> <span class="n">TouchPhase</span><span class="p">.</span><span class="n">Began</span><span class="p">)</span>     <span class="c1">// 只要刚开始按触屏幕</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_dir</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">up</span> <span class="p">*</span> <span class="n">strength</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2-用invokerepeating-实现简单的动画">2. 用<code>InvokeRepeating </code>实现简单的动画
</h4><p>需要注意的是，<code>InvokeRepeating</code> 是在 Unity 的主循环中按时间间隔调度调用指定方法，每次调用结束后会返回给引擎，等到下一个间隔再被调用。
虽然它本质不是一个死循环，但是如果在被调的方法里写 <code>while(true)</code>（或其他不会退出的循环），该方法就不会返回，主线程会被阻塞，程序/编辑器会卡死。</p>
<p>另外，通常把 <code>InvokeRepeating</code> 放在 <code>Start</code>（或 <code>Awake</code> 后的一次性初始化处），只需要调用一次来安排重复调用，Unity 会按指定间隔循环调用该方法。如果把 <code>InvokeRepeating</code> 放在 <code>Update</code> 中，每帧都会再次注册一个重复调用，结果会累积大量并发的定时调用，导致方法被多次/更频繁执行、逻辑错误和性能问题。</p>
<p>用 <code>InvokeRepeating</code>实现小鸟飞翔的动画：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">InvokeRepeating</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">AnimateSprite</span><span class="p">),</span> <span class="m">0.15f</span><span class="p">,</span> <span class="m">0.15f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">AnimateSprite</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">_sr</span><span class="p">.</span><span class="n">sprite</span> <span class="p">=</span> <span class="n">sprites</span><span class="p">[</span><span class="n">_index</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">_index</span><span class="p">++;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">_index</span> <span class="p">&gt;=</span> <span class="n">sprites</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">_index</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="3-视差无尽背景的一种实现思路">3. 视差+无尽背景的一种实现思路
</h4><p>教程中将背景全部按照3D的<code>Quad</code>制作，然后将2D的图片以<code>shader：Unit/Texture</code>的方式做成<code>Material</code> 。利用material中自带的Offset实现移动效果。这种方法非常简单，复用性强。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">Parallax</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="na">    [SerializeField]</span> <span class="kd">private</span> <span class="kt">float</span> <span class="n">speed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">MeshRenderer</span> <span class="n">_meshRenderer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_meshRenderer</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">MeshRenderer</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Update</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_meshRenderer</span><span class="p">.</span><span class="n">material</span><span class="p">.</span><span class="n">mainTextureOffset</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">speed</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="4-管道销毁的另一种思路">4. 管道销毁的另一种思路
</h4><p>按照通常的做法会在左侧屏幕边缘增加一个触发器，管道预制体碰到这个触发器后执行 <code>Destroy</code>。教程中使用了一个更简单的方法，根据像素位置来进行销毁：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="kt">float</span> <span class="n">_killEdge</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">_killEdge</span> <span class="p">=</span> <span class="n">Camera</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">ScreenToWorldPoint</span><span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">).</span><span class="n">x</span> <span class="p">-</span> <span class="m">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Update</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Other codes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">&lt;</span> <span class="n">_killEdge</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Destroy</span><span class="p">(</span><span class="n">gameObject</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="5-unity中的几个坐标系">5. Unity中的几个坐标系
</h4><h5 id="world-坐标world">World 坐标（World）
</h5><ul>
<li>Unity 的世界坐标以世界原点 (0,0,0) 为参考，单位是 Unity unit（通常当作米）</li>
<li>轴方向：X 向右，Y 向上，Z 向前（正 Z 朝向 Scene 视图的前方）</li>
<li><code>GameObject</code> 的 <code>transform.position</code> 是世界坐标；<code>transform.localPosition</code> 是相对于父对象的局部坐标</li>
</ul>
<h5 id="屏幕坐标screen">屏幕坐标（Screen）
</h5><ul>
<li>
<p>以像素为单位，原点在屏幕左下角 (0,0)，右上角是 (<code>Screen.width</code>, <code>Screen.height</code>)</p>
</li>
<li>
<p>旧的 <code>IMGUI（OnGUI）</code>以左上角为原点；UI 的坐标行为还会受 <code>Canvas Render Mode（Screen Space / World Space</code>）影响</p>
</li>
</ul>
<h5 id="视口坐标viewport">视口坐标（Viewport）
</h5><ul>
<li>
<p>归一化坐标，范围在 [0,1]，左下为 (0,0)，右上为 (1,1)</p>
</li>
<li>
<p>可用 Camera.ViewportToWorldPoint / WorldToViewportPoint 转换</p>
</li>
</ul>
<p>在上述管道销毁的例子中，使用 <code>Camera.ScreenToWorldPoint(Vector3 screenPoint)</code> 对左下角屏幕坐标原点，（0, 0 ,0）即坐标原点<code>Vector3.zero</code> 进行了转换，这样才能和<code>Update</code>中的<code>transform.position.x</code>处于同一坐标系下，才有比较的可能。</p>
<h4 id="6-游戏的重启和暂停">6. 游戏的重启和暂停
</h4><p>最简单的方法就是使用 <code>Time.timeScale</code>。</p>
<h3 id="复盘-1">复盘
</h3><p>因为是2D游戏，所以可以直接使用诸如<code>Vector3.up</code>、<code>Vector3.left</code>这样的代码来表示方向，大大简化了代码。教程中的一些设计思路非常简便好用，比如把背景做成3D quad，运用API <code>_meshRenderer.material.mainTextureOffset</code> 来实现无尽背景和视差效果；还有通过将某一个点的坐标从屏幕坐标转换为世界坐标，物体通过这个点后销毁，而不是依靠传统的碰撞检测，可以节省性能；还有关于简单的动画，不用Unity自带的动画系统，转而使用 <code>InvokeRepeating</code> 配合遍历图片的方式，简单高效地解决了问题。</p>
<p>在我自己的实践方面，练习了 GameManager 和 AudioManager 的单例模式，并重温了音效的播放和UI的交互设计。这个游戏虽然是个入门级的小游戏，但是我还是学到了很多。</p>
<h4 id="代码复用-1">代码复用
</h4><h5 id="spawner的一种写法">Spawner的一种写法
</h5><p>使用 <code>InvokeRepeating</code> 达到间隔时间生成游戏物体的效果。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">OnEnable</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">InvokeRepeating</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Spawn</span><span class="p">),</span> <span class="n">startSpawn</span><span class="p">,</span> <span class="n">spawnRate</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">OnDisable</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">CancelInvoke</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Spawn</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">GameObject</span> <span class="n">pipe</span> <span class="p">=</span> <span class="n">Instantiate</span><span class="p">(</span><span class="n">prefab</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">pipe</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">+=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">up</span> <span class="p">*</span> <span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="n">minHeight</span><span class="p">,</span> <span class="n">maxHeight</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>其他一些可复用的代码在上面的“问题与解决方法”部分都有提及，此处不再赘述。</p>
<h2 id="pong">Pong
</h2><p><strong>Tutorial Reference and Assets Source</strong>：<a class="link" href="https://www.youtube.com/watch?v=AcpaYq0ihaM"  target="_blank" rel="noopener"
    >油管-Zigurous</a></p>
<p><strong>Source Code</strong>： <a class="link" href="https://gitee.com/nullshow/unity-mini-game-pong"  target="_blank" rel="noopener"
    >on Gitee</a></p>
<h3 id="游戏简介-1">游戏简介
</h3><p>《乒乓球》（Pong） 是电子游戏史上最早、最具影响力的街机游戏之一，由 Atari 公司于 1972 年发布。它模拟了现实中的乒乓球（Table Tennis）运动，被认为是第一个取得商业成功的电子游戏。</p>
<p><strong>核心玩法</strong>：</p>
<ul>
<li>游戏画面为一个二维平面，左右两侧各有一个垂直的“球拍”（paddle），中间是一个移动的小球</li>
<li>玩家控制一侧的球拍上下移动（通常通过摇杆或按键），目标是将球反弹回对方场地</li>
<li>如果一方未能接到球，对方得一分</li>
<li>小球碰到上下边界会反弹，碰到左右边界则判定为得分</li>
<li>随着游戏进行，球速可能逐渐加快，增加难度</li>
</ul>
<img src="4-pong.gif" alt="" style="zoom:80%;"/>
<h3 id="游戏功能拆解-1">游戏/功能拆解
</h3><h4 id="内容-1">内容
</h4><p>场景摆放、玩家球拍、球、电脑球拍、UI（分数）</p>
<h4 id="逻辑-1">逻辑
</h4><ol>
<li>玩家通过 <code>W键/上箭头键</code> 和 <code>S键/下箭头键</code> 移动球拍击打乒乓球</li>
<li>乒乓球碰到上下边界回弹</li>
<li>乒乓球如果落入自己边界，对方得一分，反之亦然</li>
<li>显示当前的分数</li>
</ol>
<h4 id="开发步骤-1">开发步骤
</h4><ol>
<li>场景摆放</li>
<li>玩家球拍的移动</li>
<li>球移动的实现</li>
<li>电脑球拍AI的实现</li>
<li>球逐渐回弹增速</li>
<li>显示UI分数</li>
</ol>
<h3 id="遇到的问题及解决方法-2">遇到的问题及解决方法
</h3><h4 id="1-angular-drag-和-linear-drag">1. <code>Angular Drag</code> 和 <code>Linear Drag</code>
</h4><p>在 <code>Rigidbody</code> 中的 <code>Angular Drag</code> 代表角阻力系数，如果不想要旋转的效果，要把它手动设置为0（默认为0.05），同时在 <code>Constraints</code> 中禁止 <code>z轴</code> 的旋转。 在类似这个游戏的2D游戏中一般需要这样的操作。</p>
<p><code>Linear Drag</code> 则适用于位置移动，较高的阻力值会让对象受碰撞或力影响后的旋转更快停止。</p>
<h4 id="2-fixedupdate的使用说明">2. <code>FixedUpdate</code>的使用说明
</h4><p>不要在 <code>FixedUpdate</code> 直接读取输入。原因是<code>FixedUpdate</code> 按物理步长调用，可能丢失输入事件或导致输入响应不稳定。</p>
<p>正确做法是在 <code>Update()</code> 读取输入并把结果存到字段，随后在 <code>FixedUpdate()</code> 根据该字段施加力。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Update</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">GetKey</span><span class="p">(</span><span class="n">KeyCode</span><span class="p">.</span><span class="n">W</span><span class="p">)</span> <span class="p">||</span> <span class="n">Input</span><span class="p">.</span><span class="n">GetKey</span><span class="p">(</span><span class="n">KeyCode</span><span class="p">.</span><span class="n">UpArrow</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_dir</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">up</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">GetKey</span><span class="p">(</span><span class="n">KeyCode</span><span class="p">.</span><span class="n">S</span><span class="p">)</span> <span class="p">||</span> <span class="n">Input</span><span class="p">.</span><span class="n">GetKey</span><span class="p">(</span><span class="n">KeyCode</span><span class="p">.</span><span class="n">DownArrow</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_dir</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">down</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_dir</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">FixedUpdate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">_dir</span><span class="p">.</span><span class="n">sqrMagnitude</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Rb</span><span class="p">.</span><span class="n">AddForce</span><span class="p">(</span><span class="n">_dir</span> <span class="p">*</span> <span class="n">strength</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote class="alert alert-note">
    <p><code>FixedUpdate</code> 主要用于与物理系统同步的更新。</p></blockquote>
<p><strong>适合放在 <code>FixedUpdate</code> 里的任务</strong>：</p>
<ul>
<li>应用力/扭矩（<code>Rb.AddForce / AddRelativeForce</code>）或直接设置 <code>Rigidbody.velocity</code></li>
<li>使用 <code>Rigidbody.MovePosition / MoveRotation</code>（针对 <code>Kinematic Rigidbody</code>）</li>
<li>与物理步长一致的计时器、物理约束与求解逻辑（确定性模拟、网络服务器物理步）</li>
<li>基于物理状态的查询（在物理步长内做的碰撞检测/Overlap/射线检测）</li>
<li>物理预测/插值/外推逻辑（以固定步长进行同步）</li>
</ul>
<p>不适合放在 <code>FixedUpdate</code> 里的任务：(需要以帧为单位或更低延迟处理)</p>
<ul>
<li>输入读取</li>
<li>渲染/摄像机跟随</li>
<li>UI 更新</li>
<li>动画（通常在 Update 或 LateUpdate）</li>
</ul>
<h4 id="3-小球接触回弹效果的实现">3. 小球接触回弹效果的实现
</h4><p>使用这样的代码无法达到效果，原因可能是方向计算错误，使用 -rb.velocity 并不等同于基于碰撞法线的反射，小球可能沿着错误的方向被推动。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">OnCollisionEnter2D</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">CompareTag</span><span class="p">(</span><span class="s">&#34;Ball&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Rigidbody2D</span> <span class="n">rb</span> <span class="p">=</span> <span class="n">other</span><span class="p">.</span><span class="n">gameObject</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="n">_dir</span> <span class="p">=</span> <span class="n">rb</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">normalized</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">rb</span><span class="p">.</span><span class="n">AddForce</span><span class="p">(-</span><span class="n">_dir</span> <span class="p">*</span> <span class="n">strength</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里应该使用碰撞接触点的法线解决：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">OnCollisionEnter2D</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">CompareTag</span><span class="p">(</span><span class="s">&#34;Ball&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Rigidbody2D</span> <span class="n">rb</span> <span class="p">=</span> <span class="n">other</span><span class="p">.</span><span class="n">gameObject</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="n">_dir</span> <span class="p">=</span> <span class="n">other</span><span class="p">.</span><span class="n">GetContact</span><span class="p">(</span><span class="m">0</span><span class="p">).</span><span class="n">normal</span><span class="p">;</span>  <span class="c1">// 碰撞点的法线</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">rb</span><span class="p">.</span><span class="n">AddForce</span><span class="p">(-</span><span class="n">_dir</span> <span class="p">*</span> <span class="n">strength</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="4-使用-eventsystem-实现玩家和电脑的得分">4. 使用 <code>EventSystem</code> 实现玩家和电脑的得分
</h4><p>感觉实现的方式和按钮很像。</p>
<p>代码解释：</p>
<ul>
<li><code>TriggerEvent</code> 本质上是 <code>UnityEvent&lt;BaseEventData&gt;</code> 的一个别名/子类，可以在 Inspector 或代码里注册接收 <code>BaseEventData</code> 的回调</li>
</ul>
<ul>
<li>构造一个 <code>BaseEventData</code> ，并把当前 <code>EventSystem</code> 作为来源，callback 可以读取这个 <code>eventData</code>             来获取上下文</li>
<li>通过 <code>scoreTrigger.Invoke</code> 触发已注册的所有回调，传入 <code>eventData</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">ScoringArea</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="na">    [SerializeField]</span> <span class="kd">private</span> <span class="n">EventTrigger</span><span class="p">.</span><span class="n">TriggerEvent</span> <span class="n">scoreTrigger</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">OnCollisionEnter2D</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">gameObject</span><span class="p">.</span><span class="n">CompareTag</span><span class="p">(</span><span class="s">&#34;Ball&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">BaseEventData</span> <span class="n">eventData</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BaseEventData</span><span class="p">(</span><span class="n">EventSystem</span><span class="p">.</span><span class="n">current</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">scoreTrigger</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="n">eventData</span><span class="p">);</span> <span class="c1">// 调用已注册的eventData</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="复盘-2">复盘
</h3><p>教程中使用了父类 <code>Paddle</code> 和两个子类<code>PlayerPaddle</code>和<code>ComputerPaddle</code>的方法，一些公共的代码，如获取组件等放在父类中，在两个子类中分别写自己的逻辑。在C++的项目里经常会用到继承的方法，但是在做Unity项目的时候我经常会忘记使用，在以后的实践中要提醒自己在合适的时机多多使用。</p>
<h4 id="代码复用-2">代码复用
</h4><p>本游戏中可复用的代码已在“问题和解决方法”部分提及：</p>
<ul>
<li>小球回弹的实现</li>
<li>使用 <code>EventSystem</code> 灵活实现多个函数的回调</li>
</ul>
<h2 id="asteroids">Asteroids
</h2><p><strong>Tutorial Reference and Assets Source</strong>：<a class="link" href="https://www.youtube.com/watch?v=cIeWhztKyAg"  target="_blank" rel="noopener"
    >油管-Zigurous</a></p>
<p><strong>Source Code</strong>： <a class="link" href="https://gitee.com/nullshow/unity-mini-game-asteroids"  target="_blank" rel="noopener"
    >on Gitee</a></p>
<h3 id="游戏简介-2">游戏简介
</h3><p>《小行星》（Asteroids）是由 Atari 公司于 1979 年推出的一款经典街机射击游戏，以其简洁的矢量图形和紧张刺激的玩法成为电子游戏史上的里程碑之作。</p>
<p><strong>核心玩法</strong>：</p>
<ul>
<li>玩家控制一艘小型飞船，在无重力的太空中自由移动（可推进、旋转、射击）
<ul>
<li>按下 <code>W键/ 上箭头</code> 或者 <code>S键/下箭头</code> 可以旋转</li>
<li>按下 <code>A键/ 左键头</code>、<code>D键/右箭头</code>可以左/右推进</li>
<li>按下 <code>空格</code> 或者点击 <code>鼠标左键</code> 可以发射子弹</li>
</ul>
</li>
<li>屏幕中不断出现大小不一的“小行星”，它们会从边缘进入并随机漂移</li>
<li>目标：用激光炮击碎所有小行星
<ul>
<li>大/中行星被击中后会分裂成更小的碎片（例如：大 → 中 → 小 → 消失）</li>
<li>完全清除当前波次的小行星后，进入下一关，难度递增（小行星数量/速度增加）</li>
</ul>
</li>
<li>失败：
<ul>
<li>飞船碰到小行星会立即毁灭（通常有有限生命次数）</li>
</ul>
</li>
<li>其他特点：
<ul>
<li>飞船或小行星从一侧飞出，会从对侧重新进入（“卷屏”效果）</li>
<li>飞船有动量，即使停止推进也会继续滑行，需反向推进减速</li>
</ul>
</li>
</ul>
<img src="5-asteroid.gif" alt="" style="zoom:100%;"/>
<h3 id="游戏功能拆解-2">游戏/功能拆解
</h3><h4 id="内容-2">内容
</h4><p>场景摆放、玩家、行星、爆炸特效</p>
<h4 id="逻辑-2">逻辑
</h4><ol>
<li>玩家移动和射击</li>
<li>小行星随机生成和移动</li>
<li>小行星被玩家击中后分裂，直至消失</li>
<li>玩家碰到小行星后，这一局失败</li>
<li>显示当前的分数</li>
<li>全部局数用尽，游戏结束</li>
</ol>
<h4 id="开发步骤-2">开发步骤
</h4><ol>
<li>场景设置</li>
<li>玩家部分
<ul>
<li>移动</li>
<li>射击</li>
</ul>
</li>
<li>小行星部分
<ul>
<li>行星预制体（不同的形状、大小、质量、初始角度）</li>
<li>生成行星</li>
<li>实现分裂/销毁逻辑</li>
</ul>
</li>
<li>一局的结束
<ul>
<li>玩家死亡与复活</li>
<li>玩家的爆炸特效</li>
</ul>
</li>
<li>显示UI分数</li>
<li>全部局数用尽，游戏结束</li>
</ol>
<h3 id="遇到的问题及解决方法-3">遇到的问题及解决方法
</h3><h4 id="1-物体间物理碰撞层的设置">1. 物体间物理碰撞层的设置
</h4><p>通过 <code>Project Setting</code> 中的 <code>Physics 2D</code> 来忽略玩家和子弹、子弹与子弹之间的碰撞检测。</p>
<h4 id="2-小行星初始状态的设置">2. 小行星初始状态的设置
</h4><p>因为此项目中的小行星有不同的变体，包括大小、图片、出现时的初始角度等多个参数都不同，所以采取的策略时在小行星的预制体中就将其全部设置好。这样做的好处是在小行星的 <code>Spawner.cs</code> 脚本里，预制体可以直接生成，做到了脚本的各司其职。<code>Asteroid.cs</code> 负责小行星本身的属性，<code>Spawner.cs</code> 脚本负责小行星的生成。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">Asteroid</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="na">    [SerializeField]</span> <span class="kd">private</span> <span class="n">Sprite</span><span class="p">[]</span> <span class="n">sprites</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [SerializeField]</span> <span class="kd">private</span> <span class="kt">float</span> <span class="n">size</span> <span class="p">=</span> <span class="m">1f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [SerializeField]</span> <span class="kd">private</span> <span class="kt">float</span> <span class="n">speed</span> <span class="p">=</span> <span class="m">1f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">float</span> <span class="n">minSize</span> <span class="p">=</span> <span class="m">0.5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">float</span> <span class="n">maxSize</span> <span class="p">=</span> <span class="m">1.5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">SpriteRenderer</span> <span class="n">_sr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Rigidbody2D</span> <span class="n">_rb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_sr</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">SpriteRenderer</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="n">_rb</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_sr</span><span class="p">.</span><span class="n">sprite</span> <span class="p">=</span> <span class="n">sprites</span><span class="p">[</span><span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">sprites</span><span class="p">.</span><span class="n">Length</span><span class="p">)];</span>
</span></span><span class="line"><span class="cl">        <span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">Random</span><span class="p">.</span><span class="k">value</span> <span class="p">*</span> <span class="m">360</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//size = Random.Range(minSize, maxSize);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">transform</span><span class="p">.</span><span class="n">localScale</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">one</span> <span class="p">*</span> <span class="n">size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">_rb</span><span class="p">.</span><span class="n">mass</span> <span class="p">=</span> <span class="n">size</span><span class="p">;</span> <span class="c1">// mass随着size变化</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">SetTrajectory</span><span class="p">(</span><span class="n">Vector2</span> <span class="n">dir</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_rb</span><span class="p">.</span><span class="n">AddForce</span><span class="p">(</span><span class="n">dir</span> <span class="p">*</span> <span class="n">speed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>小行星初始的旋转角度</strong>：</p>
<p>使用 <code>Random.value</code>，这个值在0~1之间，小行星在 <code>z轴</code> 旋转，所以可以简单处理为 <code>transform.eulerAngles = new Vector3(0, 0, Random.value * 360);</code></p>
<p><strong>小行星的size部分处理</strong>：</p>
<p>不能放在 <code>Asteroid.cs</code> 里，因为这个脚本后面会进行小行星分裂的逻辑，如果在 <code>Start()</code> 里对 <code>size</code> 取随机值，会导致分裂的逻辑错误。随机size的逻辑放在 <code>Spawner.cs</code> 里处理。这是我在这个项目遇到的一个大坑。</p>
<h4 id="3-小行星生成和移动的实现思路">3. 小行星生成和移动的实现思路
</h4><p>小行星生成在以屏幕为圆心，一定半径的圆内。它们向着圆心运动。为了增加随机性，增加了朝向圆心的偏移角度。因为是沿着 z轴 进行偏移的，所以可以用 <code>Quaternion.AngleAxis(float angle, Vector3.forward)</code> 实现。</p>
<p>在小行星的移动上，本身方法由 <code>Asteroid.cs</code> 负责，<code>Spawner.cs</code> 通过获得一个Asteroid 的实例化对象调用。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"> <span class="kd">private</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="n">InvokeRepeating</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Spawn</span><span class="p">),</span> <span class="n">spawnInterval</span><span class="p">,</span> <span class="n">spawnInterval</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 行星生成在离spawner为圆心的一定半径的位置</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Spawn</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Vector2</span> <span class="n">spawnOffset</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">insideUnitCircle</span> <span class="p">*</span> <span class="n">spawnRadius</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Vector2</span> <span class="n">spawnPos</span> <span class="p">=</span> <span class="p">(</span><span class="n">Vector2</span><span class="p">)</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">+</span> <span class="n">spawnOffset</span><span class="p">;</span>   <span class="c1">// 以Spawner为圆心、一定半径内的某个随机位置</span>
</span></span><span class="line"><span class="cl">    <span class="n">Vector2</span> <span class="n">dir</span> <span class="p">=</span> <span class="p">((</span><span class="n">Vector2</span><span class="p">)</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">-</span> <span class="n">spawnPos</span><span class="p">).</span><span class="n">normalized</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 在方向上加上一个角度的偏移量</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">variance</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(-</span><span class="n">trajectoryAngle</span><span class="p">,</span> <span class="n">trajectoryAngle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quaternion</span> <span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">AngleAxis</span><span class="p">(</span><span class="n">variance</span><span class="p">,</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">forward</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">GameObject</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">Instantiate</span><span class="p">(</span><span class="n">asteroidPrefab</span><span class="p">,</span> <span class="n">spawnPos</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Asteroid</span> <span class="n">asteroid</span> <span class="p">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Asteroid</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="n">asteroid</span><span class="p">.</span><span class="n">size</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="n">asteroid</span><span class="p">.</span><span class="n">minSize</span><span class="p">,</span> <span class="n">asteroid</span><span class="p">.</span><span class="n">maxSize</span><span class="p">);</span>	<span class="c1">// 在此处处理生成小行星的随机尺寸问题</span>
</span></span><span class="line"><span class="cl">    <span class="n">asteroid</span><span class="p">.</span><span class="n">SetTrajectory</span><span class="p">(</span><span class="n">rotation</span> <span class="p">*</span> <span class="n">dir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>需要注意的是，最终小行星的轨道方向是 rotaton * dir，rotation本身是一个四元数，这里将旋转作用于向量，即 旋转后的向量 = Quaternion * 原始向量</p>
<blockquote class="alert alert-warning">
    <p>Quaternion 必须在乘号左边！</p></blockquote>
<p>其中的原理在数学的相关学习中再做详尽探讨，此处不再赘述。</p>
<h5 id="关于-quaternion的补充">关于 Quaternion的补充
</h5><p>应该避免直接修改 Quaternion 的x, y, z, w 分量，因为它们不是角度而是复杂的复数数学，直接修改会导致异常。</p>
<blockquote class="alert alert-warning">
    <p>始终使用Unity提供的API！</p></blockquote>
<p><strong>常用的API</strong>：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>场景</th>
          <th>方法</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>旋转一个向量</td>
          <td><code>rotatedVector = quaternion * vector;</code></td>
      </tr>
      <tr>
          <td>让物体看向某个方向</td>
          <td><code>Quaternion.LookRotation(vector);</code></td>
      </tr>
      <tr>
          <td>把(0,90,0)转为四元数</td>
          <td><code>Quaternion.Euler(0, 90, 0);</code></td>
      </tr>
      <tr>
          <td>获取四元数的度数</td>
          <td><code>quaternion.eulerAngles;</code></td>
      </tr>
  </tbody>
</table></div>
<h4 id="4-玩家无敌时间的设计思路">4. 玩家无敌时间的设计思路
</h4><p>通过更改玩家物理碰撞层的方法 <code>LayerMask.NameToLayer(layerName);</code>实现，非常简单明了，再使用 <code>Invoke</code> 来设定需要等待的时间即可。</p>
<h4 id="5-粒子系统的设置">5. 粒子系统的设置
</h4><p>因为我在UI的逻辑中使用了 <code>Time.scaleTime</code> 来控制游戏的结束和开始，为了避免粒子系统拖到下一轮开始游戏的那一瞬间播放，需要在面板里将粒子系统的 <code>Delta Time</code> 设置为 <code>Unscaled</code> 。</p>
<h3 id="复盘-3">复盘
</h3><p>这个项目中需要大量使用关于旋转的方法，常用的API要熟练使用。另外相关的数学知识也需要补充一下。</p>
<p>这个项目还有两个方法值得注意，可以经常尝试使用：</p>
<p><strong>通过传参获得另一个脚本中的对象</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">//======= GameManager.cs =======</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 函数的定义放在这里，因为里面很多用到的参数由GameManager统一管理</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">void</span> <span class="n">AsteroidDestroyed</span><span class="p">(</span><span class="n">Asteroid</span> <span class="n">asteroid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">asteroid</span><span class="p">.</span><span class="n">size</span> <span class="p">&lt;=</span> <span class="m">0.75f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">score</span> <span class="p">+=</span> <span class="m">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">asteroid</span><span class="p">.</span><span class="n">size</span> <span class="p">&lt;=</span> <span class="m">1.3f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">score</span> <span class="p">+=</span> <span class="m">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">score</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Vector2</span> <span class="n">pos</span> <span class="p">=</span> <span class="n">asteroid</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">explosion</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">pos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">explosion</span><span class="p">.</span><span class="n">Play</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//========== Asteroid.cs =========</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 方法的调用由Asteroid类本身管理，在小行星碰撞后调用</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">OnCollisionEnter2D</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">gameObject</span><span class="p">.</span><span class="n">CompareTag</span><span class="p">(</span><span class="s">&#34;Bullet&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="p">*</span> <span class="m">0.5f</span> <span class="p">&gt;=</span> <span class="n">minSize</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">CreateHalf</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">CreateHalf</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Destroy</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">gameObject</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Destroy</span><span class="p">(</span><span class="n">gameObject</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">GameManager</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">AsteroidDestroyed</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>在一个脚本中调用另一个脚本中的函数</strong>：</p>
<p>可以通过GameObject或者直接通过另一个类的游戏物体来获得：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="c1">//=========== Spawner.cs ============</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 通过实例化Asteroid对象来调用它的SetTrejactory方法</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Spawn</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Other codes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">GameObject</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">Instantiate</span><span class="p">(</span><span class="n">asteroidPrefab</span><span class="p">,</span> <span class="n">spawnPos</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Asteroid</span> <span class="n">asteroid</span> <span class="p">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Asteroid</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="n">asteroid</span><span class="p">.</span><span class="n">size</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="n">asteroid</span><span class="p">.</span><span class="n">minSize</span><span class="p">,</span> <span class="n">asteroid</span><span class="p">.</span><span class="n">maxSize</span><span class="p">);</span>   <span class="c1">// 在此处处理生成小行星的随机尺寸问题</span>
</span></span><span class="line"><span class="cl">    <span class="n">asteroid</span><span class="p">.</span><span class="n">SetTrajectory</span><span class="p">(</span><span class="n">rotation</span> <span class="p">*</span> <span class="n">dir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="代码复用-3">代码复用
</h4><h5 id="1-玩家无敌时间的设计">1. 玩家无敌时间的设计
</h5><p>通过更改物理碰撞层，配合<code>Invoke</code>的使用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">OnCollisionEnter2D</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">gameObject</span><span class="p">.</span><span class="n">CompareTag</span><span class="p">(</span><span class="s">&#34;Asteroid&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">GameManager</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">lives</span><span class="p">--;</span>
</span></span><span class="line"><span class="cl">        <span class="n">gameObject</span><span class="p">.</span><span class="n">SetActive</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Invoke</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Respawn</span><span class="p">),</span> <span class="n">respawnTime</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Respawn</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">gameObject</span><span class="p">.</span><span class="n">SetActive</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">gameObject</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">gameObject</span><span class="p">.</span><span class="n">layer</span> <span class="p">=</span> <span class="n">LayerMask</span><span class="p">.</span><span class="n">NameToLayer</span><span class="p">(</span><span class="s">&#34;No Collision&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Invoke</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">ResetLayer</span><span class="p">),</span> <span class="n">invulnerableTime</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">ResetLayer</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">gameObject</span><span class="p">.</span><span class="n">layer</span> <span class="p">=</span> <span class="n">LayerMask</span><span class="p">.</span><span class="n">NameToLayer</span><span class="p">(</span><span class="s">&#34;Player&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="2-清除场景中所有物体">2. 清除场景中所有物体
</h5><p>在《飞翔的小鸟》和《小行星》的游戏重置中，都用到了同样的方法，使用 <code>FindObjectsOfType</code> 通过数组遍历场景中所有需要查找的物体进行销毁即可。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="n">Asteroid</span><span class="p">[]</span> <span class="n">asteroids</span> <span class="p">=</span> <span class="n">FindObjectsOfType</span><span class="p">&lt;</span><span class="n">Asteroid</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">asteroids</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Destroy</span><span class="p">(</span><span class="n">asteroids</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">gameObject</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/en/tags/game-dev/">Game Dev</a>
        
            <a href="/en/tags/unity/">Unity</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-copyright">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-clock">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Jan 23, 2026 17:12 &#43;0800
        </span>
    </section></footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/en/p/solidsolid-principles-in-project-practice/">
        
        
            <div class="article-image">
                <img src="/en/p/solidsolid-principles-in-project-practice/cover.9d88b009e10e58d65c068a49f8bcecd4_hu_6e3415ec20f88f5b.webp" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 【SOLID】SOLID Principles in Project Practice"
                        
                        data-hash="md5-nYiwCeEOWNZcBopJ&#43;Lzs1A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【SOLID】SOLID Principles in Project Practice</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/en/p/c-game-dev-from-scratchplant-star-brawl-gameplay-layer/">
        
        
            <div class="article-image">
                <img src="/en/p/c-game-dev-from-scratchplant-star-brawl-gameplay-layer/cover.e96e49817326b44b0b37f8ca149de357_hu_d394295e071989b1.webp" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 【C&#43;&#43; Game Dev from Scratch】Plant Star Brawl - Gameplay Layer"
                        
                        data-hash="md5-6W5JgXMmtEsLN/jKFJ3jVw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【C&#43;&#43; Game Dev from Scratch】Plant Star Brawl - Gameplay Layer</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/en/p/c-game-dev-from-scratchplant-star-brawl-framework-design/">
        
        
            <div class="article-image">
                <img src="/en/p/c-game-dev-from-scratchplant-star-brawl-framework-design/cover.b4ac8d23547e58b8fea55b0948769665_hu_e5d83f6feaae04dc.webp" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 【C&#43;&#43; Game Dev from Scratch】Plant Star Brawl - Framework Design"
                        
                        data-hash="md5-tKyNI1R&#43;WLj&#43;pVsJSHaWZQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【C&#43;&#43; Game Dev from Scratch】Plant Star Brawl - Framework Design</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/en/p/c-game-dev-from-scratchteyvat-survivors/">
        
        
            <div class="article-image">
                <img src="/en/p/c-game-dev-from-scratchteyvat-survivors/cover.2074225f101a4c9d2f4143010a76f8b3_hu_6ae5d33c4eb615a7.webp" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 【C&#43;&#43; Game Dev from Scratch】Teyvat Survivors"
                        
                        data-hash="md5-IHQiXxAaTJ0vQUMBCnb4sw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【C&#43;&#43; Game Dev from Scratch】Teyvat Survivors</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/en/p/c-game-dev-from-scratchfundamental/">
        
        
            <div class="article-image">
                <img src="/en/p/c-game-dev-from-scratchfundamental/cover.c9643ba4458d00df827006ed1c8182aa_hu_56e39fb92708d9cb.webp" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 【C&#43;&#43; Game Dev from Scratch】Fundamental"
                        
                        data-hash="md5-yWQ7pEWNAN&#43;CcAbtHIGCqg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【C&#43;&#43; Game Dev from Scratch】Fundamental</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
       
    <section class="totalcount">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        

        发表了11篇文章 ·
        总计4万6千字
        <br>
    </section>


    
    <section class="running-time">
        本博客已运行
        <span id="runningdays" class="running-days"></span>
    </section>

    <section class="copyright">
        &copy;
        
        2025 -
        
        2026 Nullshow
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener"
                data-version="3.31.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>

</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script><script type="text/javascript" src="/ts/custom.711fbb0ee2e4cf3223d76423fbe2fc4e019ec898fb854a9d7bea4eb3169278df.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<script>
(() => {
    
    if (window.__L2D_WIDGET_INITED__) return;
    window.__L2D_WIDGET_INITED__ = true;

    const cdnPath = "https://cdn.jsdelivr.net/gh/letere-gzj/live2d-widget-v3@main";
    const config = {
        path: {
            homePath: "/",
            modelPath: "https://cdn.jsdelivr.net/gh/NullshowJL/hugo-static-resources@3aa0848/",
            cssPath: '\/waifu\/waifu.css',
            tipsJsonPath: '\/waifu\/waifu-tips.json',
            tipsJsPath: cdnPath + "/waifu-tips.js",
            live2dCorePath: cdnPath + "/Core/live2dcubismcore.js",
            live2dSdkPath: cdnPath + "/live2d-sdk.js"
        },
        tools: ["hitokoto", "asteroids", "express", "switch-model", "switch-texture", "photo", "info", "quit"],
        drag: { enable: true, direction: ["x", "y"] },
        switchType: "order"
    };

    if (screen.width >= 768) {
        Promise.all([
            loadExternalResource(config.path.cssPath, "css"),
            loadExternalResource(config.path.live2dCorePath, "js"),
            loadExternalResource(config.path.live2dSdkPath, "js"),
            loadExternalResource(config.path.tipsJsPath, "js")
        ]).then(() => {
            initWidget({
                waifuPath: config.path.tipsJsonPath,
                cdnPath: config.path.modelPath,
                tools: config.tools,
                dragEnable: config.drag.enable,
                dragDirection: config.drag.direction,
                switchType: config.switchType
            });
        });
    }

    function loadExternalResource(url, type) {
        return new Promise((resolve, reject) => {
            let tag;
            if (type === "css") {
                tag = document.createElement("link");
                tag.rel = "stylesheet";
                tag.href = url;
            } else if (type === "js") {
                tag = document.createElement("script");
                tag.src = url;
            }
            if (tag) {
                tag.onload = () => resolve(url);
                tag.onerror = () => reject(url);
                document.head.appendChild(tag);
            }
        });
    }
})();
</script>

<style>
     
    #waifu #waifu-tool,
    #waifu .waifu-tool,
    #waifu .waifu-toolbar,
    #waifu .waifu-tools {
        transform: translateY(-50px);
        z-index: 1001;  
    }
</style>


<style>
    @font-face {
        font-family: 'WenKai';
        src: url(https://nullshowjl.github.io/font/WenKai.ttf) format('truetype');
    }

    @font-face {
        font-family: 'Mate';
        src: url(https://nullshowjl.github.io/font/Mate.ttf) format('truetype');
    }

    @font-face {
        font-family: 'SourceCodePro';
        src: url(https://nullshowjl.github.io/font/SourceCodePro.ttf) format('truetype');
    }

    :root {
        --base-font-family: 'Mate', 'WenKai', sans-serif;
        --code-font-family: 'SourceCodePro';
    }

    body {
        font-family: 'Mate', 'WenKai', sans-serif;
        font-display: swap;
    }

    code,
    pre {
        font-family: var(--code-font-family), monospace;
        white-space: pre;
         
        tab-size: 4;
         
    }
</style>


<style>
  #TableOfContents > ul ul,
  #TableOfContents > ul ol,
  #TableOfContents > ol ul,
  #TableOfContents > ol ol { display: none; }
  #TableOfContents .open { display: block; }
</style>

<script>
    function initTocHide() {
        const toc = document.querySelector(".widget--toc");
        if (!toc) return;

        window.addEventListener("scroll", () => {
            document.querySelectorAll(".open").forEach((ul) => ul.classList.remove("open"));

            const currentLi = document.querySelector(".active-class");
            if (!currentLi) return;

            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open");
            }

            let ul = currentLi.parentElement;
            while (ul && (ul.localName === "ul" || ul.localName === "ol")) {
                ul.classList.add("open");
                ul = ul.parentElement?.parentElement;
            }
        });
    }

    initTocHide();
</script>


<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        right: left: 60%;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url('https://nullshowjl.github.io/icons/backTop.svg');
        background-size: cover;
    }
</style>

<script>
    function initScrollTop() {
        const rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) return;

        const btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop;
        rightSideBar.appendChild(btn);

        window.onscroll = () => {
            const scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
            btn.style.display = scrollTop > 20 ? "block" : "none";
        };
    }

    function backToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
    }

    initScrollTop();
</script>


<style>
    .highlight {
        max-height: 400px;
        overflow: hidden;
        position: relative;
    }

    .code-show {
        max-height: none !important;
        overflow: visible !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0), #fff);
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    const codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) return;

    codeBlocks.forEach((codeBlock) => {
      if (codeBlock.querySelector(".code-more-box")) return;
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) return;

      const codeMoreBox = document.createElement("div");
      codeMoreBox.classList.add("code-more-box");

      const codeMoreBtn = document.createElement("span");
      codeMoreBtn.classList.add("code-more-btn");

      const img = document.createElement("img");
      img.classList.add("code-more-img");
      img.src = 'https:\/\/nullshowjl.github.io\/icons\/codeMore.png';

      codeMoreBtn.appendChild(img);
      codeMoreBtn.addEventListener("click", () => {
        codeBlock.classList.add("code-show");
        codeMoreBox.remove();
        window.dispatchEvent(new Event("resize"));
      });

      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox);
    });
  }

  initCodeMoreBox();
</script>


<script defer src="https://cn.vercount.one/js"></script>

<script>
    function showHideView() {
        const viewCounts = document.querySelectorAll("#viewCount");
        if (!viewCounts.length) return;

        const article = document.querySelector(".article-page");
        if (!article) {
            viewCounts.forEach((ele) => {
                ele.style.display = "none";
            });
        }
    }

    showHideView();
</script>





<div id="particles-js"></div>

<script src="https://nullshowjl.github.io/background/particles.min.js"></script>
<script>
  particlesJS.load('particles-js', 'https:\/\/nullshowjl.github.io\/background\/particlesjs-config.json', function () {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
    #particles-js {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
    }
</style>


<div id="jsi-flying-fish-container" class="flying-fish-container"></div>

<script src="/js/renderer.js"></script>
<script>
    window.onload = () => {
        if (typeof RENDERER !== 'undefined') {
            RENDERER.init();
        }
    };
</script>


<script>
    (() => {
        const start = new Date('2025-09-14'); 
        const now = new Date();

        let years = now.getFullYear() - start.getFullYear();
        let months = now.getMonth() - start.getMonth();
        let days = now.getDate() - start.getDate();

        if (days < 0) {
            months -= 1;
            const prevMonth = new Date(now.getFullYear(), now.getMonth(), 0);
            days += prevMonth.getDate();
        }

        if (months < 0) {
            years -= 1;
            months += 12;
        }

        const result = `${years}年${months}月${days}天`;
        const runningEl = document.getElementById('runningdays');
        if (runningEl) {
            runningEl.textContent = result;
        }
    })();
</script>


        
<script>
(() => {
    
    if (window.__L2D_WIDGET_INITED__) return;
    window.__L2D_WIDGET_INITED__ = true;

    const cdnPath = "https://cdn.jsdelivr.net/gh/letere-gzj/live2d-widget-v3@main";
    const config = {
        path: {
            homePath: "/",
            modelPath: "https://cdn.jsdelivr.net/gh/NullshowJL/hugo-static-resources@3aa0848/",
            cssPath: '\/waifu\/waifu.css',
            tipsJsonPath: '\/waifu\/waifu-tips.json',
            tipsJsPath: cdnPath + "/waifu-tips.js",
            live2dCorePath: cdnPath + "/Core/live2dcubismcore.js",
            live2dSdkPath: cdnPath + "/live2d-sdk.js"
        },
        tools: ["hitokoto", "asteroids", "express", "switch-model", "switch-texture", "photo", "info", "quit"],
        drag: { enable: true, direction: ["x", "y"] },
        switchType: "order"
    };

    if (screen.width >= 768) {
        Promise.all([
            loadExternalResource(config.path.cssPath, "css"),
            loadExternalResource(config.path.live2dCorePath, "js"),
            loadExternalResource(config.path.live2dSdkPath, "js"),
            loadExternalResource(config.path.tipsJsPath, "js")
        ]).then(() => {
            initWidget({
                waifuPath: config.path.tipsJsonPath,
                cdnPath: config.path.modelPath,
                tools: config.tools,
                dragEnable: config.drag.enable,
                dragDirection: config.drag.direction,
                switchType: config.switchType
            });
        });
    }

    function loadExternalResource(url, type) {
        return new Promise((resolve, reject) => {
            let tag;
            if (type === "css") {
                tag = document.createElement("link");
                tag.rel = "stylesheet";
                tag.href = url;
            } else if (type === "js") {
                tag = document.createElement("script");
                tag.src = url;
            }
            if (tag) {
                tag.onload = () => resolve(url);
                tag.onerror = () => reject(url);
                document.head.appendChild(tag);
            }
        });
    }
})();
</script>

<style>
     
    #waifu #waifu-tool,
    #waifu .waifu-tool,
    #waifu .waifu-toolbar,
    #waifu .waifu-tools {
        transform: translateY(-50px);
        z-index: 1001;  
    }
</style>


<style>
    @font-face {
        font-family: 'WenKai';
        src: url(https://nullshowjl.github.io/font/WenKai.ttf) format('truetype');
    }

    @font-face {
        font-family: 'Mate';
        src: url(https://nullshowjl.github.io/font/Mate.ttf) format('truetype');
    }

    @font-face {
        font-family: 'SourceCodePro';
        src: url(https://nullshowjl.github.io/font/SourceCodePro.ttf) format('truetype');
    }

    :root {
        --base-font-family: 'Mate', 'WenKai', sans-serif;
        --code-font-family: 'SourceCodePro';
    }

    body {
        font-family: 'Mate', 'WenKai', sans-serif;
        font-display: swap;
    }

    code,
    pre {
        font-family: var(--code-font-family), monospace;
        white-space: pre;
         
        tab-size: 4;
         
    }
</style>


<style>
  #TableOfContents > ul ul,
  #TableOfContents > ul ol,
  #TableOfContents > ol ul,
  #TableOfContents > ol ol { display: none; }
  #TableOfContents .open { display: block; }
</style>

<script>
    function initTocHide() {
        const toc = document.querySelector(".widget--toc");
        if (!toc) return;

        window.addEventListener("scroll", () => {
            document.querySelectorAll(".open").forEach((ul) => ul.classList.remove("open"));

            const currentLi = document.querySelector(".active-class");
            if (!currentLi) return;

            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open");
            }

            let ul = currentLi.parentElement;
            while (ul && (ul.localName === "ul" || ul.localName === "ol")) {
                ul.classList.add("open");
                ul = ul.parentElement?.parentElement;
            }
        });
    }

    initTocHide();
</script>


<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        right: left: 60%;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url('https://nullshowjl.github.io/icons/backTop.svg');
        background-size: cover;
    }
</style>

<script>
    function initScrollTop() {
        const rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) return;

        const btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop;
        rightSideBar.appendChild(btn);

        window.onscroll = () => {
            const scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
            btn.style.display = scrollTop > 20 ? "block" : "none";
        };
    }

    function backToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
    }

    initScrollTop();
</script>


<style>
    .highlight {
        max-height: 400px;
        overflow: hidden;
        position: relative;
    }

    .code-show {
        max-height: none !important;
        overflow: visible !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0), #fff);
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    const codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) return;

    codeBlocks.forEach((codeBlock) => {
      if (codeBlock.querySelector(".code-more-box")) return;
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) return;

      const codeMoreBox = document.createElement("div");
      codeMoreBox.classList.add("code-more-box");

      const codeMoreBtn = document.createElement("span");
      codeMoreBtn.classList.add("code-more-btn");

      const img = document.createElement("img");
      img.classList.add("code-more-img");
      img.src = 'https:\/\/nullshowjl.github.io\/icons\/codeMore.png';

      codeMoreBtn.appendChild(img);
      codeMoreBtn.addEventListener("click", () => {
        codeBlock.classList.add("code-show");
        codeMoreBox.remove();
        window.dispatchEvent(new Event("resize"));
      });

      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox);
    });
  }

  initCodeMoreBox();
</script>


<script defer src="https://cn.vercount.one/js"></script>

<script>
    function showHideView() {
        const viewCounts = document.querySelectorAll("#viewCount");
        if (!viewCounts.length) return;

        const article = document.querySelector(".article-page");
        if (!article) {
            viewCounts.forEach((ele) => {
                ele.style.display = "none";
            });
        }
    }

    showHideView();
</script>





<div id="particles-js"></div>

<script src="https://nullshowjl.github.io/background/particles.min.js"></script>
<script>
  particlesJS.load('particles-js', 'https:\/\/nullshowjl.github.io\/background\/particlesjs-config.json', function () {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
    #particles-js {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
    }
</style>


<div id="jsi-flying-fish-container" class="flying-fish-container"></div>

<script src="/js/renderer.js"></script>
<script>
    window.onload = () => {
        if (typeof RENDERER !== 'undefined') {
            RENDERER.init();
        }
    };
</script>


<script>
    (() => {
        const start = new Date('2025-09-14'); 
        const now = new Date();

        let years = now.getFullYear() - start.getFullYear();
        let months = now.getMonth() - start.getMonth();
        let days = now.getDate() - start.getDate();

        if (days < 0) {
            months -= 1;
            const prevMonth = new Date(now.getFullYear(), now.getMonth(), 0);
            days += prevMonth.getDate();
        }

        if (months < 0) {
            years -= 1;
            months += 12;
        }

        const result = `${years}年${months}月${days}天`;
        const runningEl = document.getElementById('runningdays');
        if (runningEl) {
            runningEl.textContent = result;
        }
    })();
</script>


    </body>
</html>


